function J = ur5BodyJacobian(theta)
%  ur5BodyJacobian of UR5
%   Input args:
%           theta - the 6x1 vector - joints vector 
%   Output args:
%           J - 6x6 BodyJacobian matrix

% what we do is calculating the jacobian in symbolic form and paste there.
theta1 = theta(1);
theta2 = theta(2);
theta3 = theta(3);
theta4 = theta(4);
theta5 = theta(5);
theta6 = theta(6);

ratio = 1000;
L1 = 425/ratio;     %mm
L2 = 392/ratio;
L3 = 109.3/ratio;
L4 = 94.75/ratio;
L5 = 82.5/ratio;
L6 = 89.2/ratio;
L7 = -49/ratio;
L8 = 122.28/ratio;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

 u1 = [ L1*cos(theta2)*cos(theta6)*sin(theta5) + L5*cos(theta2)*cos(theta3)*cos(theta4)*cos(theta6) + L8*cos(theta2)*cos(theta3)*cos(theta4)*cos(theta6) + L2*cos(theta2)*cos(theta3)*cos(theta6)*sin(theta5) - L3*cos(theta2)*cos(theta3)*sin(theta4)*sin(theta6) - L3*cos(theta2)*cos(theta4)*sin(theta3)*sin(theta6) - L3*cos(theta3)*cos(theta4)*sin(theta2)*sin(theta6) - L5*cos(theta2)*cos(theta6)*sin(theta3)*sin(theta4) - L5*cos(theta3)*cos(theta6)*sin(theta2)*sin(theta4) - L5*cos(theta4)*cos(theta6)*sin(theta2)*sin(theta3) + L7*cos(theta2)*cos(theta3)*sin(theta4)*sin(theta5) + L7*cos(theta2)*cos(theta4)*sin(theta3)*sin(theta5) + L7*cos(theta3)*cos(theta4)*sin(theta2)*sin(theta5) - L8*cos(theta2)*cos(theta6)*sin(theta3)*sin(theta4) - L8*cos(theta3)*cos(theta6)*sin(theta2)*sin(theta4) - L8*cos(theta4)*cos(theta6)*sin(theta2)*sin(theta3) - L2*cos(theta6)*sin(theta2)*sin(theta3)*sin(theta5) + L3*sin(theta2)*sin(theta3)*sin(theta4)*sin(theta6) - L7*sin(theta2)*sin(theta3)*sin(theta4)*sin(theta5) - L3*cos(theta2)*cos(theta5)*cos(theta6)*sin(theta3)*sin(theta4) - L3*cos(theta3)*cos(theta5)*cos(theta6)*sin(theta2)*sin(theta4) - L3*cos(theta4)*cos(theta5)*cos(theta6)*sin(theta2)*sin(theta3) - L4*cos(theta2)*cos(theta3)*cos(theta6)*sin(theta4)*sin(theta5) - L4*cos(theta2)*cos(theta4)*cos(theta6)*sin(theta3)*sin(theta5) - L4*cos(theta3)*cos(theta4)*cos(theta6)*sin(theta2)*sin(theta5) - L5*cos(theta2)*cos(theta3)*cos(theta5)*sin(theta4)*sin(theta6) - L5*cos(theta2)*cos(theta4)*cos(theta5)*sin(theta3)*sin(theta6) - L5*cos(theta3)*cos(theta4)*cos(theta5)*sin(theta2)*sin(theta6) - L8*cos(theta2)*cos(theta3)*cos(theta5)*sin(theta4)*sin(theta6) - L8*cos(theta2)*cos(theta4)*cos(theta5)*sin(theta3)*sin(theta6) - L8*cos(theta3)*cos(theta4)*cos(theta5)*sin(theta2)*sin(theta6) + L4*cos(theta6)*sin(theta2)*sin(theta3)*sin(theta4)*sin(theta5) + L5*cos(theta5)*sin(theta2)*sin(theta3)*sin(theta4)*sin(theta6) + L8*cos(theta5)*sin(theta2)*sin(theta3)*sin(theta4)*sin(theta6) + L3*cos(theta2)*cos(theta3)*cos(theta4)*cos(theta5)*cos(theta6);...
                                                                                                                                                                                                                     L3*cos(theta6)*sin(theta2)*sin(theta3)*sin(theta4) - L3*cos(theta2)*cos(theta3)*cos(theta6)*sin(theta4) - L3*cos(theta2)*cos(theta4)*cos(theta6)*sin(theta3) - L3*cos(theta3)*cos(theta4)*cos(theta6)*sin(theta2) - L5*cos(theta2)*cos(theta3)*cos(theta4)*sin(theta6) - L8*cos(theta2)*cos(theta3)*cos(theta4)*sin(theta6) - L2*cos(theta2)*cos(theta3)*sin(theta5)*sin(theta6) - L1*cos(theta2)*sin(theta5)*sin(theta6) + L5*cos(theta2)*sin(theta3)*sin(theta4)*sin(theta6) + L5*cos(theta3)*sin(theta2)*sin(theta4)*sin(theta6) + L5*cos(theta4)*sin(theta2)*sin(theta3)*sin(theta6) + L8*cos(theta2)*sin(theta3)*sin(theta4)*sin(theta6) + L8*cos(theta3)*sin(theta2)*sin(theta4)*sin(theta6) + L8*cos(theta4)*sin(theta2)*sin(theta3)*sin(theta6) + L2*sin(theta2)*sin(theta3)*sin(theta5)*sin(theta6) + L3*cos(theta2)*cos(theta5)*sin(theta3)*sin(theta4)*sin(theta6) + L3*cos(theta3)*cos(theta5)*sin(theta2)*sin(theta4)*sin(theta6) + L3*cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)*sin(theta6) + L4*cos(theta2)*cos(theta3)*sin(theta4)*sin(theta5)*sin(theta6) + L4*cos(theta2)*cos(theta4)*sin(theta3)*sin(theta5)*sin(theta6) + L4*cos(theta3)*cos(theta4)*sin(theta2)*sin(theta5)*sin(theta6) + L5*cos(theta5)*cos(theta6)*sin(theta2)*sin(theta3)*sin(theta4) + L8*cos(theta5)*cos(theta6)*sin(theta2)*sin(theta3)*sin(theta4) - L4*sin(theta2)*sin(theta3)*sin(theta4)*sin(theta5)*sin(theta6) - L3*cos(theta2)*cos(theta3)*cos(theta4)*cos(theta5)*sin(theta6) - L5*cos(theta2)*cos(theta3)*cos(theta5)*cos(theta6)*sin(theta4) - L5*cos(theta2)*cos(theta4)*cos(theta5)*cos(theta6)*sin(theta3) - L5*cos(theta3)*cos(theta4)*cos(theta5)*cos(theta6)*sin(theta2) - L8*cos(theta2)*cos(theta3)*cos(theta5)*cos(theta6)*sin(theta4) - L8*cos(theta2)*cos(theta4)*cos(theta5)*cos(theta6)*sin(theta3) - L8*cos(theta3)*cos(theta4)*cos(theta5)*cos(theta6)*sin(theta2);...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     L1*cos(theta2)*cos(theta5) + L2*cos(theta2)*cos(theta3)*cos(theta5) - L2*cos(theta5)*sin(theta2)*sin(theta3) - L3*cos(theta2)*cos(theta3)*cos(theta4)*sin(theta5) - L4*cos(theta2)*cos(theta3)*cos(theta5)*sin(theta4) - L4*cos(theta2)*cos(theta4)*cos(theta5)*sin(theta3) - L4*cos(theta3)*cos(theta4)*cos(theta5)*sin(theta2) + L7*cos(theta2)*cos(theta3)*cos(theta4)*sin(theta6) + L3*cos(theta2)*sin(theta3)*sin(theta4)*sin(theta5) + L3*cos(theta3)*sin(theta2)*sin(theta4)*sin(theta5) + L3*cos(theta4)*sin(theta2)*sin(theta3)*sin(theta5) + L4*cos(theta5)*sin(theta2)*sin(theta3)*sin(theta4) - L7*cos(theta2)*sin(theta3)*sin(theta4)*sin(theta6) - L7*cos(theta3)*sin(theta2)*sin(theta4)*sin(theta6) - L7*cos(theta4)*sin(theta2)*sin(theta3)*sin(theta6) - L7*cos(theta5)*cos(theta6)*sin(theta2)*sin(theta3)*sin(theta4) + L7*cos(theta2)*cos(theta3)*cos(theta5)*cos(theta6)*sin(theta4) + L7*cos(theta2)*cos(theta4)*cos(theta5)*cos(theta6)*sin(theta3) + L7*cos(theta3)*cos(theta4)*cos(theta5)*cos(theta6)*sin(theta2);...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                cos(theta2 + theta3 + theta4)*sin(theta6) + sin(theta2 + theta3 + theta4)*cos(theta5)*cos(theta6);...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                cos(theta2 + theta3 + theta4)*cos(theta6) - sin(theta2 + theta3 + theta4)*cos(theta5)*sin(theta6);...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              cos(theta2 + theta3 + theta4 + theta5)/2 - cos(theta2 + theta3 + theta4 - theta5)/2];                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                           
 u2 = [L4*cos(theta5)*cos(theta6) - L7*cos(theta5) - L2*cos(theta4)*sin(theta6) - L5*sin(theta5)*sin(theta6) - L8*sin(theta5)*sin(theta6) - L1*cos(theta3)*cos(theta4)*sin(theta6) - L2*cos(theta5)*cos(theta6)*sin(theta4) + L1*sin(theta3)*sin(theta4)*sin(theta6) - L1*cos(theta3)*cos(theta5)*cos(theta6)*sin(theta4) - L1*cos(theta4)*cos(theta5)*cos(theta6)*sin(theta3);...
                  L1*cos(theta6)*sin(theta3)*sin(theta4) - L4*cos(theta5)*sin(theta6) - L5*cos(theta6)*sin(theta5) - L8*cos(theta6)*sin(theta5) - L1*cos(theta3)*cos(theta4)*cos(theta6) - L2*cos(theta4)*cos(theta6) + L2*cos(theta5)*sin(theta4)*sin(theta6) + L1*cos(theta3)*cos(theta5)*sin(theta4)*sin(theta6) + L1*cos(theta4)*cos(theta5)*sin(theta3)*sin(theta6);...
                                                                                                                                                                                                                                                                                            sin(theta5)*(L1*sin(theta3 + theta4) - L4 + L7*cos(theta6) + L2*sin(theta4));...
                                                                                                                                                                                                                                                                                                                                                 cos(theta6)*sin(theta5);...
                                                                                                                                                                                                                                                                                                                                                -sin(theta5)*sin(theta6);...
                                                                                                                                                                                                                                                                                                                                                             cos(theta5)];                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                 
                                                                                                                 
  u3 = [ L4*cos(theta5)*cos(theta6) - L7*cos(theta5) - L2*cos(theta4)*sin(theta6) - L5*sin(theta5)*sin(theta6) - L8*sin(theta5)*sin(theta6) - L2*cos(theta5)*cos(theta6)*sin(theta4);...
                  L2*cos(theta5)*sin(theta4)*sin(theta6) - L4*cos(theta5)*sin(theta6) - L5*cos(theta6)*sin(theta5) - L8*cos(theta6)*sin(theta5) - L2*cos(theta4)*cos(theta6);...
                                                                                                                          sin(theta5)*(L7*cos(theta6) - L4 + L2*sin(theta4));...
                                                                                                                                                     cos(theta6)*sin(theta5);...
                                                                                                                                                    -sin(theta5)*sin(theta6);...
                                                                                                                                                                 cos(theta5)];                                                                                                               
                                                                                                                 

                                      
                                           
 u4 = [L4*cos(theta5)*cos(theta6) - L7*cos(theta5) - L5*sin(theta5)*sin(theta6) - L8*sin(theta5)*sin(theta6);...
                - L4*cos(theta5)*sin(theta6) - L5*cos(theta6)*sin(theta5) - L8*cos(theta6)*sin(theta5);...
                                                                    -sin(theta5)*(L4 - L7*cos(theta6));...
                                                                               cos(theta6)*sin(theta5);...
                                                                              -sin(theta5)*sin(theta6);...
                                                                                           cos(theta5)];                                           
                                           
                                           
           
           
u5 = [  -cos(theta6)*(L5 + L8);...
  sin(theta6)*(L5 + L8);...
        -L7*sin(theta6);...
           -sin(theta6);...
           -cos(theta6);...
                      0];          
           
           
u6 = [-L7;0;0;0;0;1];

J = [u1,u2,u3,u4,u5,u6];

end